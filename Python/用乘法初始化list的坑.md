# [python技巧]用乘法初始化list的坑



## 1. python中用乘法初始化list

在python中使用List乘法可以构建重复元素，比如：

```python
a = [1]*10
print(a)
a[0] = 10
print(a)

b = [{'a': 1}] * 10
print(b)
b[0]['a'] = 10
print(b)
```

结果是：

```python
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[10, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[{'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}, {'a': 1}]
[{'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}, {'a': 10}]
```

## 2. 存在这种问题的原因

list存的是int没什么关系,但是当list里面是dict时就和想的不太一样了。出现这个问题主要和"引用"有关：

原因：

> 对Python列表使用乘法，对于**不可变对象**（如数字、字符串）而言是复制值，但对**可变对象**（如列表、字典）而言则是**复制引用**，因此**对于包含可变对象的列表切莫使用列表乘法，可使用列表生成式代替。**

所以上述的list里面，虽然只改变了其中1个列表中的字典元素，但是整个list的dict都跟着改变了。这就是因为**10个dict指向了同一个dict对象的引用**。

## 3. 用列表生成式初始化重复的list

此外，利用列表生成式的方式如下：

```python
my_list = [{'x': 1} for _ in range(4)]
print(my_list);
my_list[0]['x'] = 10;
print(my_list);
```

结果为：

```python
[{'x': 1}, {'x': 1}, {'x': 1}, {'x': 1}]
[{'x': 10}, {'x': 1}, {'x': 1}, {'x': 1}]
```



## 参考

【1】https://blog.csdn.net/wangxinginnlp/article/details/53201450

【2】https://blog.csdn.net/Blateyang/article/details/90179084